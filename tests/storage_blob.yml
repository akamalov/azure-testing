- name: Test azure_rm_storageblob
  hosts: all
  tasks:
      - name: remove container foo 
        azure_rm_storageblob:
            log_mode: file
            log_path: ./storage_blob.log 
            debug: yes
            resource_group: testing 
            storage_account: clh0002 
            container: foo
            state: absent
        register: delete_response

      - debug: var=delete_response

      - name: create container foo and upload a file
        azure_rm_storageblob:
            log_mode: file
            log_path: ./storage_blob.log 
            debug: yes
            resource_group: Testing 
            storage_account: clh0002 
            container: foo
            blob: graylog.png
            src: ./files/graylog.png
            public_access: container
            content_type: 'application/image'
        register: create_response
      
      - debug: var=create_response  

      - name: download the file 
        azure_rm_storageblob:
            log_mode: file
            log_path: ./storage_blob.log 
            debug: yes
            resource_group: Testing 
            storage_account: clh0002 
            container: foo
            blob: graylog.png
            dest: ~/tmp/images/graylog.png
      
