- name: Tests storage accounts
  hosts: all
  tasks:
#      - name: remove account, if it exists
#        azure_rm_storageaccount:
#            resource_group: Testing
#            location: 'East US 2'
#            name: clh0005
#            state: absent
#            log_path: ./storage_account.log
#            log_mode: file
#            debug: yes
#        register: foo
#
#      - debug: var=foo
#       
#      - name: create an account
#        azure_rm_storageaccount:
#            resource_group: Testing
#            location: 'East US 2'
#            name: clh0005
#            type: Standard_RAGRS
#            log_path: ./storage_account.log
#            log_mode: file
#            debug: yes
#        register: foo
#
#      - debug: var=foo

      - name: List accounts 
        azure_rm_storageaccount:
            resource_group: Testing
            gather_list: yes
        register: foo
 
      - debug: var=foo

      - name: Gather facts 
        azure_rm_storageaccount:
            resource_group: Testing
            name: clh0004
            gather_facts: yes
        register: foo
 
      - debug: var=foo
